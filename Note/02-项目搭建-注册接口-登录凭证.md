# 一、项目搭建

抽取常量到 config/server.js 或者 .env 文件

抽取端口号到 .env 文件中。

.env

```
SERVER_POST=8000
MY_NAME=zzt
```

在 Node 项目中，使用 .env 文件，加载全局变量，

用到一个库 *dotenv*；安装 *dotenv*

```shell
pnpm add dotenv
```

config\server.js

```js
const dotenv = require('dotenv')

dotenv.config()

module.exports = {
  SERVER_POST
} = process.env
```

将路由抽取到 router/user.router.js 中。



```js

```



将 app 相关的代码，抽取到 app/index.js 文件中。



在 main.js 中，引入 app，启动服务。

---

用户注册接口。

在 user.router.js 中，编写用户注册接口。



将中间件的逻辑，封装在 controller/user.controller.js 文件中，使用类封装。



将数插入据库的操作，封装在 service/user.service.js 文件中，



安装 mysql2 数据库驱动。



将数据库驱动相关操作，放在 app/database.js 文件中。

判断连接数据库是否成功？使用 connectionPool.getConnection()

- 在其中测试数据库是否能连接成功。

注意：查询数据库的操作，是异步操作。



插入用户数据之前，

- 判断用户名是否为空？
- 判断用户名是否已存在？



将 user.controller.js 中，判断用户数据的代码，抽取到 router 中，中间件前面。

在封装到 middleware/user.middleware.js 文件中。

将错误信息的处理，封装到 utils/handle.error.js 文件中。

将错误信息配置为常量。



再封装一个中间件，用于对密码的加密。

- 不要在数据库中存储明文密码。

使用 md5 加密。

导入 Node 中，内置的库 crypto

使用 md5 加密，并转成十六进制的形式。

---

用户登录接口



为什么需要登录凭证？



理解 http 是无状态协议。



cookie 是什么？

cookie 一般由后端设置。

存储在客户端中（浏览器）

浏览器发送网络请求时，会自动携带 cookie，



演示 cookie 的存储。

在前端设置 cookie

删除 cookie，事将时间设置为 0



cookie 的常见属性。

